

#include<stdio.h>
//#include <Windows.h>
class CCleanMalwareRegEntry
{
public:
	CCleanMalwareRegEntry();
	~CCleanMalwareRegEntry();


public:
	
	BOOL   RegDelnodeRecurse(HKEY hKeyRoot, LPTSTR lpSubKey);
	BOOL   DeleteInvalidKey(HKEY hKeyRoot, LPTSTR lpSubKey);
	DWORD  SetRegSZValue(TCHAR *pSubKey, TCHAR *pValueName, TCHAR *pValueData, bool, HKEY hPredKey);
	DWORD  SetRegDWORDValue(TCHAR *pSubKey, TCHAR *pValueName, DWORD dwSetValueData, bool bCheck, HKEY hPredKey);
	DWORD  EnumRegValueDataDeletion(LPCTSTR pSubKey, TCHAR *pValueData, HKEY hPredKey);
	DWORD  EnumRegValueNameDeletion(LPCTSTR pSubKey, TCHAR *pEntryName, HKEY hPredKey);
	DWORD  CleanMalwareRegEntry(LPCTSTR pszFilePath, bool &bStatus);
	DWORD  EnumRegValueDataForCurrentUsers(LPTSTR lpszSubKey, TCHAR *pValueData);
	DWORD  EnumRegValueDataDeletionForCurrentUsers(HKEY hSubKey, TCHAR *pSubKey, TCHAR *pValueData, HKEY hPredKey);
    DWORD  CheckServiceValidPath(HKEY hSubKey, TCHAR *pPath);
	
	TCHAR* MyToUpper(TCHAR *input);
	TCHAR*  CheckForPathExist(TCHAR *pPath);
	
protected:
	TCHAR	szPath[512];
	
	TCHAR	szWindowsDir[256];
	TCHAR	szSystemDir[256];
	TCHAR	szProgramDir[256];
	TCHAR	szProgramDirX86[256];
	TCHAR	szApplPath[512];
	TCHAR	szAppDataPath[512];
	TCHAR	szCommProgram[512];
	TCHAR	szProgramData[256];
	TCHAR	szUserProfile[256];
	TCHAR	szTempLocal[256];
	TCHAR	szPublic[256];
	TCHAR	szAppData[256];
	TCHAR	m_szCommProgramX86[256];
	BOOL	m_bIsWow64;
	bool	m_bIsx64;

};

