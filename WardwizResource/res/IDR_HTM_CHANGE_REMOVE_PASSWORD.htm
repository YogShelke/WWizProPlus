<html custom-frame="solid-with-shadow" lang="ENGLISH">
	<head>
	<link href="IDR_TIS_ENGLISH.tis" hreflang="ENGLISH" rel="translation">
	<link href="IDR_TIS_GERMAN.tis" hreflang="GERMAN" rel="translation">
	<include src="IDR_HTM_FONT_AWESOME.htm" />	
	<style>
	@import url(IDR_CSS_GERMAN_LANG.css);
	@import url(IDR_CSS_MAIN.css);
    html 
    {
        width:323dip;           /* preferred/initial width */
        height:auto!important;          /* content will not overflow, no vertical scrollbars on the window */
        overflow:hidden;
    }
	.set_chkbox_btn_app_setting{
		margin-top:5dip;
		margin-bottom:5dip;
		margin-left:33dip;
	}
	.set_chkbox_btn_app_setting:collapsed{
		visibility:none;
	}
	
	.set_chkbox_btn_folder_locker{
		margin-top:5dip;
		margin-bottom:5dip;
		margin-left:33dip;
	}
	.set_chkbox_btn_folder_locker:collapsed{
		visibility:none;
	}
	.set_chkbox_btn_parental_control{
		margin-top:5dip;
		margin-bottom:5dip;
		margin-left:33dip;
	}
	.set_chkbox_btn_parental_control:collapsed{
		visibility:none;
	}
	.set_chkbox_btn_uninstall{
		margin-top:5dip;
		margin-bottom:5dip;
		margin-left:33dip;
	}
	.set_chkbox_btn_uninstall:collapsed{
		visibility:none;
	}
	.set_pwd_txt{
		margin-top:8dip;
		margin-bottom:2dip;
		margin-left:33dip;	
		font-size:13dip;
	}	
	.set_chkbox_text{
		margin-right:3dip;
	}
	.pwd_dsc{
		padding-left:33dip;
		padding-right:33dip;
	}
	.pwd_dsc:collapsed{
		visibility:none;
	}
	.pwd_dsc:expanded{
		visibility:visible;
	}	
	.message_display_block_changeRemovePassword:collapsed {
		visibility:visible;
		top:40dip;
		transition:top(sine-in-out, 600ms);
	}
	body.changeRemovePassword{ 
		max-width:322dip!important;
		height:auto!important;
		background-size:cover;
		padding:0; 
		margin:0; 
		border:0.5dip solid #3d748e; 
		padding-bottom:15dip;
		padding-left:0dip;
	}
	.header_changeRemovePassword{
		background:rgba(0,0,0,.3);
		flow:horizontal;
		width:322dip;        
		height:40dip!important;
	}
	.input_password_changeRemovePassword{	
		margin-left:33dip;	
		width:250dip;
		margin-bottom:5dip;
		display:inline-block;
		height:16.5dip;
	}
	.btnIcon_changeRemovePassword{
		margin-left:75dip;
	}
	.message_display_block_changeRemovePassword {
		background:rgba(238,246,248,.95);
		position:absolute;
		width:321dip;
		visibility:none;
		margin-left:0dip;
		top:0;
	}	
	.message_display_block_changeRemovePassword p{
		margin-top:5dip;
		margin-bottom:5dip;
		text-align:center;
		color:#000;
	}
	</style>
	
	<script type="text/tiscript">
	function SetValues()
	{
		var isValidPassword  = true;			
		var varPassword = $(#EnterPassword).value;
		var varConfirmPassword = $(#ConfirmPassword).value;
		var regexp = /[0-9]/gi;
		var matchesArray = varPassword.search(regexp);
		var spregexp = /[~,`,!,@,#,$,%,^,&,*,(,),_,-,+,=,{,},[,\],|,\,?,\/,.,,,',:,;,<,>]/gi;
		var matchesArraySp = varPassword.search(spregexp);
		
		if(matchesArray < 0 )
		{
			isValidPassword = false;
			self.timer(50ms,function (){
				$(#ID_EXCEPTION_MSG).text =Lang.translate("ID_PASSWORD_SHOULD_CONTAIN_ONE_DIGIT");
				$(.message_display_block_changeRemovePassword).state.collapsed = true;
			});
			$(#ConfirmPassword).value ="";
			$(#EnterPassword).value = "";
			return false;
		}
		if(matchesArraySp < 0 )
		{
			isValidPassword = false;
			self.timer(50ms,function (){
				$(#ID_EXCEPTION_MSG).text =Lang.translate("IDS_STATIC_FLDRLCKPSSWRD_VALIDSPL");
				$(.message_display_block_changeRemovePassword).state.collapsed = true;
			});
			$(#ConfirmPassword).value ="";
			$(#EnterPassword).value = "";
			return false;
		}
		if(varPassword.length >= 1 && varPassword.length < 5)
		{
			isValidPassword = false;
			self.timer(50ms,function (){
				$(#ID_EXCEPTION_MSG).text =Lang.translate("IDS_STATIC_FLDRLCKPSSWRD_VALID5");
				$(.message_display_block_changeRemovePassword).state.collapsed = true;
			});
			$(#ConfirmPassword).value ="";
			$(#EnterPassword).value = "";
			return false;
		}
		return true;
	}
	
	function ValidatePassword()
	{
		var isValidPassword  = true;
		var varPassword = $(#EnterPassword).value;
		if(varPassword.length == 0 && $(.pwd_dsc).state.collapsed == true )
		{
			isValidPassword = false;
			self.timer(50ms,function (){
				$(#ID_EXCEPTION_MSG).text =Lang.translate("ID_PLZ_ENTER_PWD");
				$(.message_display_block_changeRemovePassword).state.collapsed = true;
			});
			return false;
		}
		else {
			if(varPassword.length != 0)
				if(!SetValues())
					return false;
		}
		return true;
	}
	
	function ComparePasswords()
	{
		var varPassword;
		if($(#EnterPassword).value.length == 0 || $(#EnterPassword).value.trim().length == 0)
		{
			varPassword = "";
		}	
		else{
			varPassword = $(#EnterPassword).value;
		}	
		var varConfirmPassword = $(#ConfirmPassword).value;
		if(varPassword != varConfirmPassword)
		{
			self.timer(50ms,function (){
				$(#ID_EXCEPTION_MSG).text =Lang.translate("ID_PLEASE_ENTER_SAME_PASSWORD");
				$(.message_display_block_changeRemovePassword).state.collapsed = true;
			});
			$(#ConfirmPassword).value ="";
			return false;
		}
		else
		{
			view.parameters.vArrUpdatedVal[0].password = varPassword;
		}
		return true;
	}
	</script>
	<script type="text/tiscript">
	function SetPwdForErrorMsg()
	{
		self.timer(50ms,function (){
			$(#ID_EXCEPTION_MSG).text = Lang.translate("ID_SEL_FEATURE");
			$(.message_display_block_changeRemovePassword).state.collapsed = true;	
		});
	}
	
	function SetPasswordFor()
	{
		switch(view.parameters.ProductVersion)
		{
			case #BASIC : 
			case #ESSENTIAL : if($(#ID_CHK_APP_SETTING).state.checked == false && $(#ID_CHK_UNINSTALL).state.checked == false)
							{
								SetPwdForErrorMsg();
								return false;
							}
							break;  
			case #ESSENTIALPLUS : if($(#ID_CHK_APP_SETTING).state.checked == false && $(#ID_CHK_UNINSTALL).state.checked == false && $(#ID_CHK_PARENTAL_CONTROL).state.checked == false)
								{
									SetPwdForErrorMsg();
									return false;
								}
								break;
			default : if( $(#ID_CHK_APP_SETTING).state.checked == false &&
							$(#ID_CHK_FOLDER_LOCKER).state.checked == false &&
							$(#ID_CHK_UNINSTALL).state.checked == false &&
							$(#ID_CHK_PARENTAL_CONTROL).state.checked == false)
						{
							SetPwdForErrorMsg();
							return false;
						}	
		}
				
		//"FOLDER_LOCKER":1,	"PARENTAL_CONTROL":2,	"APPLICATION_SETTING":3,	"UNINSTALL":4
		var ArrFeature = [1,2,3,4];
		for(var record in ArrFeature)
		{
			switch(record)
			{
				case 2: if($(#ID_CHK_PARENTAL_CONTROL).state.checked == true)
							view.parameters.vArrUpdatedVal[0].parental_control = 1;  
						else	
							view.parameters.vArrUpdatedVal[0].parental_control = 0;
						break;
					
				case 1: if($(#ID_CHK_FOLDER_LOCKER).state.checked == true)
							view.parameters.vArrUpdatedVal[0].folder_locker = 1; 
						else	
							view.parameters.vArrUpdatedVal[0].folder_locker = 0; 
						break;
					
				case 3: if($(#ID_CHK_APP_SETTING).state.checked == true)
							view.parameters.vArrUpdatedVal[0].settings = 1; 
						else	
							view.parameters.vArrUpdatedVal[0].settings = 0; 	
						break;
					
				case 4: if($(#ID_CHK_UNINSTALL).state.checked == true)
							view.parameters.vArrUpdatedVal[0].uninstall = 1; 
						else	
							view.parameters.vArrUpdatedVal[0].uninstall = 0; 	
						break;						
			}
		}
		return true;
	}
		
	$(#ID_BTN_SAVE).onClick = function()
	{	
		GetChangePasswordSettingsButtons();
	}
	
	function GetChangePasswordSettingsButtons()
	{
		if(!ValidatePassword())
			return;				
		if(!ComparePasswords())
			return;
		if(!SetPasswordFor())
			return;
		if($(#EnterPassword).value.length != 0 || $(#EnterPassword).value.trim().length != 0)
		{
			if(view.parameters.isSet == true)
			{
				view.close(null);
			}
			else
			{
				var vArrQA = new Array(1);
				vArrQA[0] = {question:"", answer:""}; 
				var params = { ProductVersion:view.parameters.ProductVersion, varLanguageValue:view.parameters.varLanguageValue, vArr:vArrQA, varThemeType:view.parameters.varThemeType}; // parameters to pass	
				view.dialog{
						url: self.url("IDR_HTM_FORGET_PASSWORD_SETTING.htm"),
						client:true,
						alignment:-5,
						parameters:params};
				if(vArrQA[0].question != "" && vArrQA[0].answer != "")
				{
					view.parameters.vArrUpdatedVal[0].question = vArrQA[0].question;
					view.parameters.vArrUpdatedVal[0].answer = vArrQA[0].answer;
				}
			}
		}
		view.close(null);
	}
	
	$(#ID_BTN_CANCEL).onClick = function()
	{
		view.close(null);
	}
	</script> 
	
	<script type="text/tiscript">
	function PasswordEnter(pwd) {
		var t = pwd.value;
		if(	pwd.attributes["type"] == "password")
		{
			pwd.attributes["type"] = "text";
		}	
		else
		{
			pwd.attributes["type"] = "password";
		}			
		pwd.value = t;			
	}
	
	function ChangePwdAttr(pwd) {
		var t = pwd.value;
		pwd.attributes["type"] = "password";
		pwd.value = t;			
	}
	
	$(#BTN_TOGGLE_ENTER).on("mousedown", function(evt){
		PasswordEnter($(input#EnterPassword));
	});
	
	$(#BTN_TOGGLE_ENTER).on("mouseup", function(evt){
		ChangePwdAttr($(input#EnterPassword));
	});
	
	$(#BTN_TOGGLE_CONFIRM).on("mousedown", function(evt){
		PasswordEnter($(input#ConfirmPassword));
	});
	
	$(#BTN_TOGGLE_CONFIRM).on("mouseup", function(evt){
		ChangePwdAttr($(input#ConfirmPassword));
	});
	
	$(#EnterPassword).on("keyup",function(event) {	
			if( event.keyCode == Event.VK_RETURN)
			{
				GetChangePasswordSettingsButtons();
			}	  
		});
		
	$(#ConfirmPassword).on("keyup",function(event) {	
		if( event.keyCode == Event.VK_RETURN)
		{
			GetChangePasswordSettingsButtons();
		}	  
	});
	
	event ~keypress $(#EnterPassword) (evt)
	{
		if(evt.keyCode == evt.VK_SPACE)
		{	
			return true;
		}
	} 
	
	event ~keypress $(#ConfirmPassword) (evt)
	{
		if(evt.keyCode == evt.VK_SPACE)
		{	
			return true;
		}
	} 
	</script>
	
	<script type="text/tiscript">
	$(body).onClick = function(){
		$(.message_display_block_changeRemovePassword).state.collapsed = false;
	}
	
	$(#ID_CHK_APP_SETTING).onClick = function(){
		$(.message_display_block_changeRemovePassword).state.collapsed = false;
	}
	
	$(#ID_CHK_FOLDER_LOCKER).onClick = function(){
		$(.message_display_block_changeRemovePassword).state.collapsed = false;
	}
	
	$(#ID_CHK_PARENTAL_CONTROL).onClick = function(){
		$(.message_display_block_changeRemovePassword).state.collapsed = false;
	}
	
	$(#ID_CHK_UNINSTALL).onClick = function(){
		$(.message_display_block_changeRemovePassword).state.collapsed = false;
	}
	</script> 
	
	<script type="text/tiscript">
	$(#window-close) << event click()
	{				
		view.close(null);
	}
	</script> 
	
	<script type="text/tiscript">
	function ReleaseInstance(vInstance)
	{
		if(vInstance instanceof Recordset)
		{
			vInstance.close();
		}
	}
	
	function SetFeature()
	{
		//"FOLDER_LOCKER":1,	"PARENTAL_CONTROL":2,	"APPLICATION_SETTING":3,	"UNINSTALL":4
		var ArrFeature = [1,2,3,4];	
		for(var record in ArrFeature)
		{
			switch(record)
			{
				case 1: if(view.parameters.vArrCurrentVal[0].folder_locker == true)
						{
							$(#ID_CHK_FOLDER_LOCKER).state.checked = true;									
						}								  
						break;
				case 2: if(view.parameters.vArrCurrentVal[0].parental_control == true)
						{
							$(#ID_CHK_PARENTAL_CONTROL).state.checked = true;
						}
						break;
				case 4: if(view.parameters.vArrCurrentVal[0].uninstall == true)
						{
							$(#ID_CHK_UNINSTALL).state.checked = true;
						}
						break;
				case 3: if(view.parameters.vArrCurrentVal[0].settings == true)
						{
							$(#ID_CHK_APP_SETTING).state.checked = true;
						}
						break;
			}
		}	
	}
	
	function ChangeDSC()
	{
		if(view.parameters.Flag == false)
		{
			$(.pwd_dsc).state.collapsed = true;
			$(#ID_CHK_FOLDER_LOCKER).state.checked = true;
			$(#ID_CHK_UNINSTALL).state.checked = true;
			$(#ID_CHK_PARENTAL_CONTROL).state.checked = true;
		}
		else{
			SetFeature();
		}
	}
	</script> 
	
	<script type="text/tiscript">
	function OnSetDefaultTheme()
	{
		$(body).style["background-image"] = "url(IDR_JPG_DEFAULT_BACKGRUND.jpg)";
		$(head).$append(<style>@import url(IDR_CSS_MAIN.css);</style>);
	}
	function OnSetDarkTheme()
	{
		$(body).style["background-image"] = "url(IDR_JPG_DARK_THEME.jpg)";
		$(head).$append(<style>@import url(IDR_CSS_MAIN_DARK_THEME.css);</style>);
	}
	function OnSetCrystalTheme()
	{
		$(body).style["background-image"] = "url(IDR_JPG_CRYSTAL_BACKGRUND.jpg)";
		$(head).$append(<style>@import url(IDR_CSS_MAIN_CRYSTAL_THEME.css);</style>);
	}
	</script> 
	
	<script type="text/tiscript">
	function self.ready() {	
		if(view.parameters.varThemeType == "defaultTheme"){
			OnSetDefaultTheme();
		}
		else if(view.parameters.varThemeType == "darkTheme"){
			OnSetDarkTheme();
		}	
		else if(view.parameters.varThemeType == "crystalTheme"){
			OnSetCrystalTheme();
		}				
		self.language = view.parameters.varLanguageValue;
		if(view.parameters.ProductVersion == #BASIC)
		{
			$(.set_chkbox_btn_folder_locker).state.collapsed = true;
			$(.set_chkbox_btn_parental_control).state.collapsed = true;
		}
		else if(view.parameters.ProductVersion == #ESSENTIAL)
		{
			$(.set_chkbox_btn_folder_locker).state.collapsed = true;
			$(.set_chkbox_btn_parental_control).state.collapsed = true;
		}
		else if(view.parameters.ProductVersion == #ESSENTIALPLUS)
		{
			$(.set_chkbox_btn_folder_locker).state.collapsed = true;
		}
		ChangeDSC();	
	}
	</script> 
</head>
<body .changeRemovePassword>
	<div .header_changeRemovePassword>
		<window-caption role="window-caption">
			<label>ID_PWD_PROTECTION</label>
		</window-caption>	
		<window-button #window-close></window-button>
	</div>
	<div .set_pwd_txt><label>ID_NEW_PASSWORD</label></div>
	<widget>
		<input type="password" .input_password_changeRemovePassword #EnterPassword maxlength="24">
		<div class="eye">
			<button .null_button #BTN_TOGGLE_ENTER><div>
				<svg version="1.1" id="Layer_14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
					 viewBox="0 0 500 500" enable-background="new 0 0 500 500" xml:space="preserve" class="eyeIcon">
				<path fill="none" stroke="#000000" stroke-width="15" stroke-miterlimit="10" d="M31,243c0,0,91-129,225-123s214,123,214,123
					s-97,91.2-231,91c-80.3-0.1-166-50.5-208-97"/>
				<circle fill="none" stroke="#000000" stroke-width="15" stroke-miterlimit="10" cx="245.5" cy="222.5" r="69.5"/>
				<path stroke="#000000" stroke-width="15" stroke-miterlimit="10" d="M302,250c0,24-35.2,41.7-59.2,41.7S189,272.3,189,248.2
					s29.8-43.5,53.8-43.5S302,226,302,250z"/>
				</svg>
			</div></button>
		</div>
	</widget>
	
	<div .set_pwd_txt style="margin-top:5dip;"><label>ID_CONF_PWD_SEMI</label></div>
	<widget>
		<input type="password" .input_password_changeRemovePassword  #ConfirmPassword maxlength="24">
		<div class="eye">
			<button .null_button #BTN_TOGGLE_CONFIRM><div>
				<svg version="1.1" id="Layer_14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
					 viewBox="0 0 500 500" enable-background="new 0 0 500 500" xml:space="preserve" class="eyeIcon">
				<path fill="none" stroke="#000000" stroke-width="15" stroke-miterlimit="10" d="M31,243c0,0,91-129,225-123s214,123,214,123
					s-97,91.2-231,91c-80.3-0.1-166-50.5-208-97"/>
				<circle fill="none" stroke="#000000" stroke-width="15" stroke-miterlimit="10" cx="245.5" cy="222.5" r="69.5"/>
				<path stroke="#000000" stroke-width="15" stroke-miterlimit="10" d="M302,250c0,24-35.2,41.7-59.2,41.7S189,272.3,189,248.2
					s29.8-43.5,53.8-43.5S302,226,302,250z"/>
				</svg>
			</div></button>
		</div>
	</widget>
	
	<div .pwd_dsc>
		<p #ID_PWD_MSG><label>ID_PWD_MSG</label><br/></p>
	</div>
	
	<div .set_chkbox_btn_app_setting> <input #ID_CHK_APP_SETTING|checkbox .set_chkbox_text /><label for="ID_CHK_APP_SETTING">ID_APP_SETIIGNS</label></div>
	<div .set_chkbox_btn_parental_control> <input #ID_CHK_PARENTAL_CONTROL|checkbox  .set_chkbox_text /><label for="ID_CHK_PARENTAL_CONTROL">ID_PARENTAL_CONTROL</label></div>
	<div .set_chkbox_btn_folder_locker> <input #ID_CHK_FOLDER_LOCKER|checkbox  .set_chkbox_text /><label for="ID_CHK_FOLDER_LOCKER">ID_FOLD_LOCK</label></div>
	<div .set_chkbox_btn_uninstall> <input #ID_CHK_UNINSTALL|checkbox  .set_chkbox_text /><label for="ID_CHK_UNINSTALL">ID_UNINSTALL</label></div>
	
	<div .btnIcon_changeRemovePassword>
		<div .btnCstmSmall #ID_BTN_SAVE><label>ID_REPORTS_SAVE</label></div>
		<div .btnCstmSmall #ID_BTN_CANCEL><label>ID_CANCEL</label></div>
	</div>
	<div .message_display_block_changeRemovePassword>
		<p #ID_EXCEPTION_MSG></p>
	</div> 
</body>
</html>